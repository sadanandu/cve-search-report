from flask import Flask
from flask_pymongo import PyMongo
from bson.objectid import ObjectId
import json
import datetime

class JSONEncoder(json.JSONEncoder):
    def default(self, o):
        if isinstance(o, ObjectId):
            return str(o)
        if isinstance(o, datetime.datetime):
            return str(o)
        return json.JSONEncoder.default(self, o)

app = Flask(__name__)
app.config["MONGO_URI"] =  "mongodb+srv://supersada:75NHIDchTbod7G8y@cluster101-agkiq.mongodb.net/CVE"
app.json_encoder=JSONEncoder
mongo = PyMongo(app)

@app.route('/')
def hello():
    cve = mongo.db.cve_item.find_one({"cve.CVE_data_meta.ID" : "CVE-2020-0001"})
    return cve
